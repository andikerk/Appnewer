//----------------------raty---------------------------------------
var refreshRating = function(){

  $('.rating').raty({
    starHalf: '<%= asset_path 'star-half.png' %>',
    starOff: '<%= asset_path 'star-off.png' %>',
    starOn: '<%= asset_path 'star-on.png' %>',
    scoreName: 'comment[rating]'
  });

  $('.rated').raty({
    starHalf: '<%= asset_path 'star-half.png' %>',
    starOff: '<%= asset_path 'star-off.png' %>',
    starOn: '<%= asset_path 'star-on.png' %>',
    readOnly: true,
    score: function() {
      return $(this).attr('data-score');
    }
  });
};

//consent to terms and conditions--------------------------------

function showConditionsConsent(){
  $('#conditionsconsent').fadeIn();
  $('#stripebtn').hide();
}

function hideConditionsConsent(){
  $('#conditionsconsent').hide();
}
//---------------stripe----------------------------------
function showStripebtn(){
  var check = $("#accept").is(':checked');

  if(check === true){
    $('#stripebtn').fadeIn();
  } 
  if(check === false){
    $('#stripebtn').hide();
  } 
}

// ----------------------artisanry------------------------
var rot;
var gruen;
var blau;
var opak;
var lineWidth =25;
var begin;
var interval = 1000; 
var sum = 0;  
var looplim;

function startDraw(){ 
  refreshCanvas();
  begin = true;
  looplim = 4;
  setInterval(function(){
    drawLine();
    },
    interval); 
}

function stopDraw(){
  begin = false;
}
function carryOn(){
  begin = true; 
}
function clearThis(){
  location.reload(); 
}
var refreshCanvas = function(){
  var c=document.getElementById("myCanvas");
    c.width = 1800;
    c.height = 600;
} 

function drawLine(){if(begin == true){
    var c=document.getElementById("myCanvas");
    var x = []; var y =[] ;
    var picno = Math.floor(Math.random()*3)*600;
    for (var i =  0; i <Math.random()*looplim; i++ ){

      var kolor ="rgba" + "(" +(rot)+ "," +(gruen)+ "," +(blau)+ "," +(opak)+ ")";
            x[0] = Math.random()*600 + picno; y[0] = Math.random()*600;
            var ctx=c.getContext("2d"); 
            ctx.beginPath();
            ctx.moveTo(x[i],y[i]);
            x[i+1] = Math.random()*600 + picno; y[i+1] = [Math.random()*600];
           if(i%3 == 0){
            ctx.lineTo(x[i+1],y[i+1]);
          }
           if(i%3 == 1 ){
            ctx.quadraticCurveTo(600- y[i] + picno, x[i] -picno, x[i+1], y[i+1]);
          }
          if (i%3 == 2){
            ctx.bezierCurveTo( picno, 0, 600 + picno, 0, x[i+1], y[i+1]);
          }
            ctx.strokeStyle = kolor;

            ctx.lineWidth = lineWidth;
            console.log(lineWidth);
           // ctx.shadowBlur = 10;
           // ctx.shadowColor = kolor;
            ctx.stroke();
            x[i]=x[i+1];y[i]=y[i+1];  

       
    }
    sum++;
    }

}



//--------------landing page--------------------------------------------------------
function landingPage(){

  $('#pic1').on('load',function(){$('this').show();})
  $('#pic2').on('load',function(){$('#pic1,this').show();})
  $('#pic3').on('load',function(){$('#pic1,#pic2,#pic3').show();})
  $('#pic1,#pic2,#pic3').css("animation-play-state","running"); 
}

//----------------fake credentials----------------------------

var landpage;


var TEXT = ['"Great People"','"Amazing bicycles"','"I recommend it"','"THE place to go!"',
'"Friendly staff"','"So competent!"','"Nice guys!"','"You should go there!"','"They did a great job!"',
'"excellent!"','"They know what they\'re doing"'];

var KOL =["red", "darkblue", "darkgreen", "darkred", "orange"];
var Zeit = 3000; 

var credent = function(){
   if(landpage === true){
   var X = Math.random()*50+"vw"; var Y = Math.random()*40+"vw";
   var T =Math.floor(TEXT.length*Math.random());
   var S = Math.random()*1.8+.5 + "em";
   var K = Math.floor(KOL.length*Math.random());
   var show = Math.random()*Zeit + 1000;

  $('#schnecke').html(TEXT[T]).css('color',KOL[K]).css({'left':X,'top':Y,'font-size':S})
  .fadeIn(1000,"swing").delay(show).fadeOut(1000,"swing");  
  setTimeout(credent,Zeit*2);
  }  
}
 
var credent1 = function(){
   if(landpage === true){
   var X = Math.random()*50+"vw"; var Y = Math.random()*40+"vw";
   var T =Math.floor(TEXT.length*Math.random());
   var S = Math.random()*1.8+.5 + "em";
   var K = Math.floor(KOL.length*Math.random());
   var show1 = Math.random()*Zeit/2 + 500;
   
  $('#schnecke1').html(TEXT[T]).css('color',KOL[K]).css({'left':X,'top':Y,'font-size':S})
  .fadeIn(500,"swing").delay(show1).fadeOut(500,"swing");  
  setTimeout(credent1,Zeit);
  }  
}       
      

//=============document ready================================================================

$(document).on('turbolinks:load ajaxSuccess', function(){


  $('.alert').delay(3000).fadeOut(2000);
  $('.notice').delay(3000).fadeOut(2000);

//-----landing_page fake credentials------
  landpage = false;
  if(window.location.pathname == "/" || window.location.pathname =="/static_pages/landing_page"){
  landpage = true;
  }

  credent();
  credent1();
//--------landing_page images
  landingPage();








//--------------repairs page------------------------------

  $('#test').animate({left:'40vw',top:'20vh',width: '45vw',height: '19.5vw'},3330)
  .delay(3330).animate({left:'40vw',top:'200vh',width: '0vw',height: '0vw'},3330);



//----------------product show view------------------------------  
// elevateZoom freezes mobile devices, so only for larger screens
// elevateZoom is in vendor/assets

if(window.screen.width>800)
{    
    $('.img-zoom').elevateZoom({
      zoomType: "lens",
      lensShape: "round",
      lensSize: 200
    });
} 
//-------------raty plugin
refreshRating();

$('#logout').on('click',function(){
  $('#byeBye').css("display","block");
})

//-------------cookie consent-------------------------------
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#1d8a8a",
      "text": "#62ffaa"
    },
    "button": {
      "background": "transparent",
      "text": "#afed71",
      "border": "#afed71"
    }
  }/*, 
  "content": {"message":"_! K E K S E A L A R M K E K S E A L A R M !_", "dismiss": "KAPIERT!",
    "link": "KEKSEWEITERBILDUNG"
  }*/,"theme": "classic"
})});


//----------about_page/ artisanry------------------
  looplim = 0;

//---------------------------------Colorpicker/artisanry-----------------------------------
  function setColor(){

    // Get the slider values,
    // stick them together.
     rot = sliders[0].noUiSlider.get(); 
     gruen = sliders[1].noUiSlider.get(); 
     blau = sliders[2].noUiSlider.get(); 
     opak = sliders[3].noUiSlider.get()/255; 
     lineWidth = sliders[4].noUiSlider.get()/5; 
   
    var color = 'rgba(' +
      sliders[0].noUiSlider.get() + ',' +
      sliders[1].noUiSlider.get() + ',' +
      sliders[2].noUiSlider.get() + ',' +
      (opak) + ')';

    // Fill the color box.

     $('#result').css("width",lineWidth);
     $('#opac .noUi-base, #opac .noUi-connect, #opac').css("background-color", color);
     $('#red .noUi-connect').css("background-color","rgba(" +(rot)+ ", 0 , 0 , 1)");
     $('#green .noUi-connect').css("background-color","rgba( 0 ,"+ (gruen) +" , 0 , 1)");
     $('#blue .noUi-connect').css("background-color","rgba( 0 , 0, "+ (blau) +" , 1)");
      resultElement.style.color = color;
      resultElement.style.backgroundColor=color;
    }

  var resultElement = document.getElementById('result'),
    sliders = document.getElementsByClassName('sliders');

  for ( var i = 0; i < sliders.length; i++ ) {

    noUiSlider.create(sliders[i], {
      start: 127,
      connect: [true, false],
      orientation: "vertical",
      range: {
        'min': 0,
        'max': 255     
      },
      format: wNumb({
        decimals: 0
      })
    });
    // Bind the color changing function to the slide event.
    sliders[i].noUiSlider.on('slide', setColor);
  }
 

 //if (navigator.geolocation) {
 // navigator.geolocation.getCurrentPosition(function(position) {
 //   $("#data").html("latitude: " + position.coords.latitude + "<br>longitude: " + position.coords.longitude);
 // });
//}
var now = new Date();
$('#data').html(now + now.toLocaleTimeString() + now.toDateString() + now.getHours() + now.getMinutes() + now.getMilliseconds());
});









